---
title: "Mini assignment 1"
author: "Kedar Patil"
date: "February 16, 2015"
output: html_document
layout: post
description: mini-assignment
tags: assignments, Kedar Patil
runtime: shiny
---

##Comparative Statistics for BRIC Countries
\  


###Background

I came across this visual comparing macro economic statistics for BRIC countries on the [Media Research Lab](https://mediaresearchlab.wordpress.com/2012/04/22/infographics-bric-in-comparison/) website. BRIC stands for a group of four countries - Brazil, Russia, India and China, which are all considered at similar stage of economic development. The original visual (reproduced below) seeks to produce a comparative understanding of these countries around 6 factors -  Population size, Population growth rate, Unemployment, Inflation, GDP, and Military expenditure.
\  


\  



```{r, echo=FALSE, message=FALSE, fig.width=7, fig.height=4}
library(png)
library(grid)
img <- readPNG("/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment/_assets/russia-and-india-in-comparison.png")
grid.raster(img)

```
\
*Figure1: Original visual from Media Research Lab*

\  



###Observations

+ *Inconsistant formatting*

    While Brazil and China population numbers are comma separated, India and       Russia are separated by a dot. Similar thing is observed for percentage values for inflation rates.   


+ *Visual representation is harder to comprehend*

    Even though all numbers are on one visual, the information is siloed, and not easily comparable. One has to work a bit to understand comparative magnitude and standings of each country on metrics that are being presented.   

+ *Distracting visuals*

    The purpose of human figures represented on country maps is unclear, distracting, and adds to clutter. 

\  


###Bar Charts & Scatter plots

All of the above data can be represented in a compact form using a combination of scatter plot and bar charts. 
\  


\  


```{r, echo=FALSE, message=TRUE, warning=TRUE, fig.height=5, fig.width=4}

library("shiny")
library(ggplot2)

setwd("/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment")

bric_data <- read.csv("Bric_data.csv")

shinyApp(
  ui=fluidPage(
    selectInput("types", label="Select economic variable",
              choices=c("Population","GDP per Capita","Population Growth Rate","Inflation Rate","Unemployment Rate"), selected="Population"),
    
    plotOutput("bars")
    ),
  
  server= function(input,output){
    output$bars <-  renderPlot({ 
      
          data1 <- switch(input$types,
                   "Population"=bric_data$Population_Million,
                   "GDP per Capita"=bric_data$GDP_per_Capita,
                   "Population Growth Rate"=(bric_data$Population_Growth_Rate*100),
                   "Inflation Rate"=(bric_data$Inflation_Rate*100),
                   "Unemployment Rate"=(bric_data$Unemployment_Rate*100))

  tmp <- data.frame(bric_data$Country,data1)
        
  ggplot(tmp, aes(x=bric_data$Country, y=data1, fill=bric_data$Country)) + 
  geom_bar(stat="identity") +
  geom_text(aes(label=as.numeric(data1)), vjust=-0.5, size=3.5) +
#  scale_y_continuous(labels = "comma") +
  theme(plot.title=element_text(size=rel(2.5), face="bold")) +
  theme(axis.title.x=element_text(size=0), 
        axis.title.y=element_text(size=13),
         axis.text=element_text(size=13), 
         legend.text=element_text(size=13),
         legend.title=(element_text(size=0))) +
  labs(y=input$types)
#  labs(x="Country", y="input$types", color="Country"))
 #  ggtitle(input$types)
  
}, height=350, width=550)
}
)
```
\  
*Figure2: Distribution of variables by Country*

\  

We see that India and China have significantly higher population than Brazil and Russia. Also, Russia has the highest per capita GDP ($16,700), as well as highest inflation rate at 8.9%. It is also the only country with declining population. Brazil and India have highest population growth, little over 1%. India has highest unemployment rate at 9.8%
\  


\  



```{r, echo=FALSE, message=TRUE, warning=TRUE, fig.height=1, fig.width=4}
setwd("/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment")

bric_data <- read.csv("Bric_data.csv")

library("shiny")
library(ggplot2)

shinyApp(
  ui=fluidPage(
    selectInput("types1", label="Select economic variable1",
              choices=c("Population","GDP per Capita","Population Growth Rate","Inflation Rate","Unemployment Rate"), selected="Population"),
          
    selectInput("types2", label="Select economic variable2",
              choices=c("Population","GDP per Capita","Population Growth Rate","Inflation Rate","Unemployment Rate"), selected="GDP per Capita")
          ,
    
    plotOutput("scattr")
    ),
  
  server= function(input,output){
    output$scattr <-  renderPlot({ 
          data1 <- switch(input$types1,
                   "Population"=bric_data$Population_Million,
                   "GDP per Capita"=bric_data$GDP_per_Capita,
                   "Population Growth Rate"=(bric_data$Population_Growth_Rate*100),
                   "Inflation Rate"=(bric_data$Inflation_Rate*100),
                   "Unemployment Rate"=(bric_data$Unemployment_Rate*100))

         data2 <- switch(input$types2,
                   "Population"=bric_data$Population_Million,
                   "GDP per Capita"=bric_data$GDP_per_Capita,
                   "Population Growth Rate"=(bric_data$Population_Growth_Rate*100),
                   "Inflation Rate"=(bric_data$Inflation_Rate*100),
                   "Unemployment Rate"=(bric_data$Unemployment_Rate*100))

  tmp <- data.frame(bric_data$Country,data1,data2)

  
 ggplot(tmp, aes(x=data1, y=data2, colour=bric_data$Country, xmin=0, ymin=0)) +
  geom_point(size=3, alpha=0.8) +
#  scale_y_continuous(labels = comma) +
#  scale_x_continuous(labels = comma) +
  theme(plot.title=element_text(size=rel(1.5), face="bold")) +
  theme(axis.title=element_text(size=15), 
         axis.text=element_text(size=8), 
         legend.text=element_text(size=10),
         legend.title=(element_text(size=0))) +
  labs(x=input$types1, y=input$types2)

}, height=300, width=500)
}
)
```
*Figure3: Scatter plots of variables*
\  



Looking at same data on a scatter plot further reveals some similarities between countries. 
\  


+    Brazil and Russia are most similar in terms of number of unemployed people
+    India stands out in terms of highest unemployment as well as population growth rate
+    Russia jumps out in terms of highest GDP per capita, as well as highest inflation rate
\  


\  





###Excel Bubble Charts 

Illustration below is shown to demonstrate the effect of using country flags within a scatter plot. Using images that can be easily associated with underlying categories, makes it easier to interpret information presented.
\  

\  

```{r, echo=FALSE, message=FALSE, fig.width=6, fig.height=3.5}

library("shiny")
library(ggplot2)

shinyApp(
  ui=fluidPage(
    selectInput("types1", label="Select economic variable1",
              choices=c("Population"), selected="Population"),
          
    selectInput("types2", label="Select economic variable2",
              choices=c("GDP per Capita","Population Growth Rate","Inflation Rate","Unemployment Rate"), selected="GDP per Capita")
          ,
    
    plotOutput("scattr")
    ),
  
  server= function(input,output){
    output$scattr <-  renderPlot({ 

         data2 <- switch(input$types2,
                   #"Population"=bric_data$Population_Million,
                   "GDP per Capita"="/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment/_assets/Exl_pop_vs_gdp.png",
                   "Population Growth Rate"="/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment/_assets/Exl_pop_vs_pop_growth.png",
                   "Inflation Rate"="/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment/_assets/Exl_pop_vs_inflation.png",
                   "Unemployment Rate"="/Users/kedarpatil/Documents/St-4701 - Data Visualization/kedar.github.io/blog_assignment/_assets/Exl_pop_vs_unemployment.png")

library(png)
library(grid)
img <- readPNG(data2)
grid.raster(img)

}, height=300, width=500)
}
)
```